{{ define "main" }}
<article class="pa3 pa4-ns nested-copy-line-height">
  <section class="cf pv3 pv4-l f4 tj lh-copy" style="max-width: 80%; margin: 0 auto; text-align: center;">
    {{ .Content }}
  </section>

  <!-- Section for Head of the Working Group -->
  {{ $members := where .Pages "Params.type" "member" }}
  {{ $head := where $members "Params.role" "Head of Working Group" }}
  {{ if $head }}
  <aside class="flex flex-column justify-center items-center mt5">
    <h2 class="f3 fw6 bb b--light-gray pb2 mb4">Head of Research Group</h2>
    {{ range $head }}
      <div class="relative profile-card mb4 bg-white br4 shadow-2 pa4 paper-box" style="margin: 10px auto; display: flex; align-items: stretch;">
        <!-- Left Section -->
        <div class="left-section" style="flex: 1; display: flex; justify-content: center; align-items: center; padding: 1rem;">
          <div class="w5 h5 br-100 ba b--moon-gray overflow-hidden">
            <img src="{{ .Params.image }}" alt="{{ .Title }}" class="w-100 h-100 object-cover">
          </div>
        </div>

        <!-- Middle Section -->
        <div class="middle-section" style="flex: 3; padding: 1rem 1.5rem; display: flex; flex-direction: column; justify-content: center;">
          <h3 class="f4 fw6 near-black mb2">{{ .Title }}</h3>
          <p class="f5 i dark-gray mb3">{{ .Params.role }}</p>
          <p class="f6 lh-copy">{{ .Params.description }}</p>
        </div>

        <!-- Right Section -->
        <div class="right-section hidden-on-hover" style="flex: 1; padding: 1rem 1.5rem; display: flex; flex-direction: column; justify-content: center;">
          {{ with .Params.email }}
            <p class="f6 lh-copy mb2"><strong>Email:</strong> <a href="mailto:{{ . }}" class="link blue dim">{{ . }}</a></p>
          {{ end }}
          <!-- 
          {{ with .Params.phone }}
            <p class="f6 lh-copy mb2"><strong>Phone:</strong> {{ . }}</p>
          {{ end }}
          -->
          <p class="f6 fw6 mb2">Connect on:</p>
          <div class="ananke-socials">
            {{ with .Params.social_media }}
              {{ range . }}
                <a href="{{ .url }}" target="_blank" rel="noopener" class="link dib mr2" title="Connect on {{ .platform }}">
                  {{ $icon := resources.Get (printf "ananke/socials/%s.svg" .platform | lower) }}
                  {{ with $icon }}<span class="icon">{{ .Content | safeHTML }}</span>{{ end }}
                </a>
              {{ end }}
            {{ end }}
          </div>
        </div>
      </div>
    {{ end }}
  </aside>
  {{ end }}

 
 
  <!-- Section for Other Members -->
  {{ $members := where .Pages "Params.type" "member" }}
  {{ $group_members := where $members "Params.role" "!=" "Head of Working Group" }}
  {{ if $group_members }}
    <aside class="flex flex-column justify-center items-center mt5">
      <h2 class="f3 fw6 bb b--light-gray pb2 mb4">Group Members</h2>
      {{ $members := (where .Pages "Params.role" "!=" "Head of Working Group") }}
      {{ range $group_members }}
        <div class="relative profile-card mb4 bg-white br4 shadow-2 pa4 paper-box" style="margin: 15px auto; display: flex; align-items: stretch;">
          <!-- Left Section -->
          <div class="left-section" style="flex: 1; display: flex; justify-content: center; align-items: center; padding: 1rem;">
            <div class="w5 h5 br-100 ba b--moon-gray overflow-hidden">
              <img src="{{ .Params.image }}" alt="{{ .Title }}" class="w-100 h-100 object-cover">
            </div>
          </div>

          <!-- Middle Section -->
          <div class="middle-section" style="flex: 3; padding: 1rem 1.5rem; display: flex; flex-direction: column; justify-content: center;">
            <h3 class="f5 f4-ns fw5 mb2">{{ .Title }}</h3>
            <p class="f6 i mid-gray mb3">{{ .Params.role }}</p>
            <p class="f6 lh-copy">{{ .Params.description }}</p>
          </div>

          <!-- Right Section -->
          <div class="right-section hidden-on-hover" style="flex: 1; padding: 1rem 1.5rem; display: flex; flex-direction: column; justify-content: center;">
            {{ with .Params.email }}
              <p class="f6 lh-copy mb2"><strong>Email:</strong> <a href="mailto:{{ . }}" class="link blue dim">{{ . }}</a></p>
            {{ end }}
            <!-- 
            {{ with .Params.phone }}
              <p class="f6 lh-copy mb2"><strong>Phone:</strong> {{ . }}</p>
            {{ end }}
            -->
            <p class="f6 fw6 mb2">Connect on:</p>
            <div class="ananke-socials">
              {{ with .Params.social_media }}
                {{ range . }}
                  <a href="{{ .url }}" target="_blank" rel="noopener" class="link dib mr2" title="Connect on {{ .platform }}">
                    {{ $icon := resources.Get (printf "ananke/socials/%s.svg" .platform | lower) }}
                    {{ with $icon }}<span class="icon">{{ .Content | safeHTML }}</span>{{ end }}
                  </a>
                {{ end }}
              {{ end }}
            </div>
          </div>
        </div>
      {{ end }}
    </aside>
  {{ end }}
 


  <!-- Section for External Members -->
  {{ $external_members := where .Pages "Params.type" "external_member" }}
  {{ if $external_members }}
    <aside class="flex flex-column justify-center items-center mt5">
      <h2 class="f3 fw6 bb b--light-gray pb2 mb4">External Members</h2>
      {{ range $external_members }}
        <div class="relative profile-card mb4 bg-white br4 shadow-2 pa4 paper-box" style="margin: 15px auto; display: flex; align-items: stretch;">
          <!-- Left Section -->
          <div class="left-section" style="flex: 1; display: flex; justify-content: center; align-items: center; padding: 1rem;">
            <div class="w5 h5 br-100 ba b--moon-gray overflow-hidden">
              <img src="{{ .Params.image }}" alt="{{ .Title }}" class="w-100 h-100 object-cover">
            </div>
          </div>

          <!-- Middle Section -->
          <div class="middle-section" style="flex: 3; padding: 1rem 1.5rem; display: flex; flex-direction: column; justify-content: center;">
            <h3 class="f5 f4-ns fw5 mb2">{{ .Title }}</h3>
            <p class="f6 i mid-gray mb3">{{ .Params.role }}</p>
            <p class="f6 lh-copy">{{ .Params.description }}</p>
          </div>

          <!-- Right Section -->
          <div class="right-section hidden-on-hover" style="flex: 1; padding: 1rem 1.5rem; display: flex; flex-direction: column; justify-content: center;">
            {{ with .Params.email }}
              <p class="f6 lh-copy mb2"><strong>Email:</strong> <a href="mailto:{{ . }}" class="link blue dim">{{ . }}</a></p>
            {{ end }}
            <!--
            {{ with .Params.phone }}
              <p class="f6 lh-copy mb2"><strong>Phone:</strong> {{ . }}</p>
            {{ end }}
            -->
            <p class="f6 fw6 mb2">Connect on:</p>
            <div class="ananke-socials">
              {{ with .Params.social_media }}
                {{ range . }}
                  <a href="{{ .url }}" target="_blank" rel="noopener" class="link dib mr2" title="Connect on {{ .platform }}">
                    {{ $icon := resources.Get (printf "ananke/socials/%s.svg" .platform | lower) }}
                    {{ with $icon }}<span class="icon">{{ .Content | safeHTML }}</span>{{ end }}
                  </a>
                {{ end }}
              {{ end }}
            </div>
          </div>
        </div>
      {{ end }}
    </aside>
  {{ end }}




  <!-- Section for Collaborators -->
  {{ $collaborators := where .Pages "Params.type" "collaborator" }}
  {{ if $collaborators }}
  <aside class="mt5">
    <h2 class="f3 fw6 bb b--light-gray pb2 mb4 tc">Collaborators</h2>
    <div class="w-100 w-60-l center">
      {{ range $collaborators }}
        <div class="flex items-center mb4 pb3 bb b--light-gray">
          <!-- Left: Collaborator Name & Description -->
          <div style="flex: 3;">
            <h3 class="f5 fw6 mb1 near-black">
              {{ .Title }} <span class="mid-gray f6">({{ .Description }})</span>
            </h3>
            <!-- Affiliation -->
            <p class="f6 mid-gray mb0">
              {{ $affiliation := .Params.affiliation }}
              {{ with .Params.affiliation_link }}
                <a href="{{ . }}" class="link dim" style="color: #f09c04;">{{ $affiliation }}</a>
              {{ else }}
                {{ $affiliation }}
              {{ end }}
            </p>
          </div>

          <!-- Right: Social Media Links -->
          <div style="flex: 1; text-align: right;">
            {{ with .Params.social_media }}
              <div class="ananke-socials">
                {{ range . }}
                  <a href="{{ .url }}" target="_blank" rel="noopener" class="link dib mr2" title="Connect on {{ .platform }}">
                    <!-- Check for SVG Icon -->
                    {{ $icon := resources.Get (printf "ananke/socials/%s.svg" .platform | lower) }}
                    {{ if $icon }}
                      <span class="icon w2 h2">{{ $icon.Content | safeHTML }}</span>
                    {{ else }}
                      <!-- Fallback Text If Icon Missing -->
                      <span class="f6">{{ .platform | title }}</span>
                    {{ end }}
                  </a>
                {{ end }}
              </div>
            {{ end }}
          </div>
        </div>
      {{ end }}
    </div>
  </aside>
  {{ end }}


    
</article>
{{ end }}
